namespace :dev do
  desc "é–‹ç™ºç’°å¢ƒã®åˆæœŸã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ï¼ˆDBãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ï¼‹ã‚·ãƒ¼ãƒ‰å®Ÿè¡Œï¼‰"
  task setup: :environment do
    puts "ğŸ”§ é–‹ç™ºç’°å¢ƒã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã‚’é–‹å§‹ã—ã¾ã™..."

    # ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè¡Œ
    puts "ğŸ“Š ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œä¸­..."
    Rake::Task['db:migrate'].invoke

    # ã‚·ãƒ¼ãƒ‰å®Ÿè¡Œï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒå­˜åœ¨ã—ãªã„å ´åˆã®ã¿ï¼‰
    if User.count == 0
      puts "ğŸ‘¤ ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ‡ãƒ¼ã‚¿ãŒå­˜åœ¨ã—ãªã„ãŸã‚ã€ã‚·ãƒ¼ãƒ‰ã‚’å®Ÿè¡Œã—ã¾ã™..."
      Rake::Task['db:seed'].invoke
      puts "âœ… ã‚·ãƒ¼ãƒ‰ãƒ‡ãƒ¼ã‚¿ã‚’ä½œæˆã—ã¾ã—ãŸ"
    else
      puts "âœ… ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ‡ãƒ¼ã‚¿ã¯æ—¢ã«å­˜åœ¨ã—ã¾ã™ï¼ˆ#{User.count}äººï¼‰"
    end

    puts "ğŸ‰ é–‹ç™ºç’°å¢ƒã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ãŒå®Œäº†ã—ã¾ã—ãŸï¼"
    puts ""
    puts "ğŸ“ ãƒ­ã‚°ã‚¤ãƒ³æƒ…å ±ï¼š"
    puts "   Email: test@example.com"
    puts "   Password: password"
  end

  desc "é–‹ç™ºç’°å¢ƒã®ãƒªã‚»ãƒƒãƒˆï¼ˆDBå‰Šé™¤â†’å†ä½œæˆâ†’ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³â†’ã‚·ãƒ¼ãƒ‰ï¼‰"
  task reset: :environment do
    puts "ğŸ—‘ï¸  é–‹ç™ºç’°å¢ƒã‚’ãƒªã‚»ãƒƒãƒˆã—ã¾ã™..."

    Rake::Task['db:drop'].invoke
    Rake::Task['db:create'].invoke
    Rake::Task['db:migrate'].invoke
    Rake::Task['db:seed'].invoke

    puts "ğŸ‰ é–‹ç™ºç’°å¢ƒã®ãƒªã‚»ãƒƒãƒˆãŒå®Œäº†ã—ã¾ã—ãŸï¼"
  end
end